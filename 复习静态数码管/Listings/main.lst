C51 COMPILER V9.54   MAIN                                                                  05/14/2022 20:29:52 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include "delay.h"
   3          
   4          unsigned int count;      //æ¬¡æ•°æ ‡è¯†
   5          unsigned int angle=5;         //è§’åº¦æ ‡è¯†
   6          sbit pwm =P2^7 ;          //PWMä¿¡å·è¾“å‡º
   7          
   8          /*å®šæ—¶å™¨åˆå§‹åŒ–å‡½æ•°*/
   9          void Timer0_Init(void)          //100å¾®ç§’@11.0592MHz
  10          {
  11   1              TMOD |= 0x01;           //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  12   1              TL0 = 0xA4;             //è®¾ç½®å®šæ—¶åˆå€¼
  13   1              TH0 = 0xFF;             //è®¾ç½®å®šæ—¶åˆå€¼
  14   1              TF0 = 0;                //æ¸…é™¤TF0æ ‡å¿—
  15   1              TR0 = 1;                //å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
  16   1              ET0 = 1;
  17   1      }
  18          
  19          /*ä¸²å£åˆå§‹åŒ–å‡½æ•°*/
  20          void Uart_Init(void)            //9600bps@11.0592MHz
  21          {
  22   1              SCON = 0x50;            //8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
  23   1              TMOD |= 0x20;           //è®¾å®šå®šæ—¶å™¨1ä¸º8ä½è‡ªåŠ¨é‡è£…æ–¹å¼
  24   1              TL1 = 0xFD;             //è®¾å®šå®šæ—¶åˆå€¼
  25   1              TH1 = 0xFD;             //è®¾å®šå®šæ—¶å™¨é‡è£…å€¼
  26   1              ET1 = 0;                //ç¦æ­¢å®šæ—¶å™¨1ä¸­æ–­
  27   1              TR1 = 1;                //å¯åŠ¨å®šæ—¶å™¨1
  28   1              ES = 1;
  29   1              EA = 1;
  30   1      }
  31          
  32          /*ä¸²å£å‘é€ä¸€å­—èŠ‚å‡½æ•°*/
  33          void Uart_SendData(unsigned char dat )
  34          {
  35   1              SBUF = dat;
  36   1              while(TI == 0);
  37   1              TI = 0;
  38   1      }
  39          
  40          /*ä¸²å£å‘é€å­—ç¬¦ä¸²å‡½æ•°*/
  41          void Uart_SendString(char *s)
  42          {
  43   1              while (*s)              
  44   1              {
  45   2                      Uart_SendData(*s++);
  46   2              }
  47   1      }
  48          
  49          /*ç¨‹åºå…¥å£*/
  50          void main(void)
  51          {
  52   1              //angleä¸å¯¹åº”è§’åº¦å…³ç³»
  53   1              //4   5   6   ...... 19  20
  54   1              //0   11  22  ...... 166 177
C51 COMPILER V9.54   MAIN                                                                  05/14/2022 20:29:52 PAGE 2   

  55   1              Uart_Init();
  56   1              Timer0_Init();
  57   1              Uart_SendString("èˆµæœºæ­£åœ¨æ—‹è½¬ã€‚\r\n");
  58   1              for(angle=4;angle<21;angle++)//ä»0åˆ°177åº¦ï¼Œæ­¥è¿›11åº¦
  59   1              {
  60   2                      Delay(2);
  61   2              }
  62   1              Delay(2000);
  63   1              for(angle=21;angle>4;angle--)//ä»177åˆ°0åº¦ï¼Œæ­¥è¿›11åº¦
  64   1              {
  65   2                      Delay(2);
  66   2              }
  67   1              Uart_SendString("èˆµæœºæ­£åœ¨å¾€å¤æ—‹è½¬ã€‚\r\n");
  68   1              while(1)
  69   1              { 
  70   2                                  
  71   2              }
  72   1      }
  73          
  74          /*ä¸²å£ä¸­æ–­æœåŠ¡å‡½æ•°*/
  75          void Uart_Isr() interrupt 4
  76          {
  77   1          if (RI)
  78   1          {
  79   2              RI = 0;  
  80   2              }
  81   1      }
  82          
  83          
  84          /*å®šæ—¶å™¨ä¸­æ–­æœåŠ¡å‡½æ•°*/
  85          void Timer0_Isr() interrupt 1
  86          {
  87   1              TL0 = 0xA4;             //è®¾ç½®å®šæ—¶åˆå€¼
  88   1              TH0 = 0xFF;             //è®¾ç½®å®šæ—¶åˆå€¼
  89   1              if(count< angle)              //åˆ¤æ–­æ¬¡æ•°æ˜¯å¦å°äºè§’åº¦æ ‡è¯†
  90   1            pwm=1;                  //ç¡®å®å°äºï¼ŒPWMè¾“å‡ºé«˜ç”µå¹³
  91   1          else
  92   1            pwm=0;                  //å¤§äºåˆ™è¾“å‡ºä½ç”µå¹³
  93   1          count=(count+1);          //0.1msæ¬¡æ•°åŠ 1
  94   1          count=count%160;     //ä¿æŒå‘¨æœŸä¸º20msï¼Œæ™®é€š51å•ç‰‡æœºå®šæ—¶100usæœ‰è¯¯å·®ï¼Œç»ç¤ºæ³¢å™¨æµ‹é‡
             -çº¦ä¸º50Hz
  95   1      }
  96          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    264    ----
   CONSTANT SIZE    =     54    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
